1.FTP主动模式和被动模式
FTP是仅基于TCP的服务，不支持UDP。与众不同的是FTP使用2个端口，一个数据端口和一个命令端口（也可叫做控制端口）。通常来说这两个端口是21（命令端口）和20（数据端口）。但FTP工作方式的不同，数据端口并不总是20。这就是主动与被动FTP的最大不同之处。
（一）  主动FTP
主动方式的FTP是这样的：客户端从一个任意的非特权端口N（N>1024）连接到FTP服务器的命令端口，也就是21端口。然后客户端开始监听端口N+1，并发送FTP命令“port N+1”到FTP服务器。接着服务器会从它自己的数据端口（20）连接到客户端指定的数据端口（N+1）。
针对FTP服务器前面的防火墙来说，必须允许以下通讯才能支持主动方式FTP：     
    1. 任何大于1024的端口到FTP服务器的21端口。（客户端初始化的连接） 
    2. FTP服务器的21端口到大于1024的端口。 （服务器响应客户端的控制端口）
    3. FTP服务器的20端口到大于1024的端口。（服务器端初始化数据连接到客户端的数据端口）
    4. 大于1024端口到FTP服务器的20端口（客户端发送ACK响应到服务器的数据端口）
（二）被动FTP 
为了解决服务器发起到客户的连接的问题，人们开发了一种不同的FTP连接方式。这就是所谓的被动方式，或者叫做PASV，当客户端通知服务器它处于被动模式时才启用。在被动方式FTP中，命令连接和数据连接都由客户端发起，这样就可以解决从服务器到客户端的数据端口的入方向连接被防火墙过滤掉的问题。当开启一个 FTP连接时，客户端打开两个任意的非特权本地端口（N > 1024和N+1）。第一个端口连接服务器的21端口，但与主动方式的FTP不同，客户端不会提交PORT命令并允许服务器来回连它的数据端口，而是提交 PASV命令。这样做的结果是服务器会开启一个任意的非特权端口（P > 1024），并发送PORT P命令给客户端。然后客户端发起从本地端口N+1到服务器的端口P的连接用来传送数据。对于服务器端的防火墙来说，必须允许下面的通讯才能支持被动方式的FTP:      
    1. 从任何大于1024的端口到服务器的21端口 （客户端初始化的连接） 
    2. 服务器的21端口到任何大于1024的端口 （服务器响应到客户端的控制端口的连接）
    3. 从任何大于1024端口到服务器的大于1024端口 （客户端初始化数据连接到服务器指定的任意端口） 
    4. 服务器的大于1024端口到远程的大于1024的端口（服务器发送ACK响应和数据到客户端的数据端口）可以简单概括为以下两点： 
    1、主动FTP： 
            命令连接：客户端 >1024端口 -> 服务器 21端口 
            数据连接：客户端 >1024端口 <- 服务器 20端口
      2、被动FTP：
            命令连接：客户端 >1024端口 -> 服务器 21端口
            数据连接：客户端 >1024端口 -> 服务器 >1024端口
（三） 主动与被动FTP优缺点：        
   主动FTP对FTP服务器的管理有利，但对客户端的管理不利。因为FTP服务器企图与客户端的高位随机端口建立连接，而这个端口很有可能被客户端的防火墙阻塞掉。被动FTP对FTP客户端的管理有利，但对服务器端的管理不利。因为客户端要与服务器端建立两个连接，其中一个连到一个高位随机端口，而这个端口很有可能被服务器端的防火墙阻塞掉。
 
2.NFS服务原理
NFS是C/S模式，首先要有一台服务端跑NFS服务，然后各个客户端直接挂载共享目录使用。NFS服务本身不会监听端口，服务端和客户端通信是通过RPC协议来完成的。
RPC（Remote Procedure Call）远程过程调用协议，一种通过网络从远程计算机程序上请求服务，而不需要了解底层网络技术的协议。它是一项广泛用于支持分布式应用程序（不同组件分布在不 同计算机上的应用程序）的技术。
再来看NFS的通信过程
如上图所示，当访问程序通过NFS客户端向NFS服务端存取文件时，其请求数据流程如下几点：
1、首先用户访问网站程序，由程序在NFS客户端上发出NFS文件存取功能的询问请求，这时NFS客户端（即执行程序的服务器）RPC服务（portmap 或rpcbind服务）就会通过网络向NFS服务端的RPC服务（即portmap或rpcbind服务）的111端口发出NFS文件存取功能的询问请求。
2、NFS服务端的RPC服务（即portmap或rpcbind服务）找到对应的已注册的NFSdaemon端口后，通知NFS客户端的RPC服务（即portmap或rpcbind服务）。
3、此时NFS客户端就可获取到正确的端口，然后就直接与NFS daemon联机存取数据了。
4、NFS客户端把数据存取成功后，返回给前端程序，告诉用户存取结果，作为网站用户，我们就完成了一次存取操作。
由于NFS的各项功能都需要向RPC服务（即portmap或rpcbind）注册，所以RPC服务（即portmap或rpcbind服务）才能获取到NFS服务的各项对应的端口号（portnumber）、PID、NFS在主机所监听的IP等，而NFS客户端才能够通过向RPC服务（即portmap或rpcbind服务）询问从而找到正确的端口。
